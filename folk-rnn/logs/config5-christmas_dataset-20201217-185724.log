vocabulary size: 151
n tunes: 3333
n train tunes: 3141.0
n validation tunes: 192.0
min, max length 2 10037
Building the model
  number of parameters: 5661608
  layer output shapes:               #params:   output shape:
    InputLayer                       0          (64, None)
    EmbeddingLayer                   22801      (64, None, 151)
    InputLayer                       0          (64, None)
    LSTMLayer                        1360896    (64, None, 512)
    DropoutLayer                     0          (64, None, 512)
    LSTMLayer                        2100224    (64, None, 512)
    DropoutLayer                     0          (64, None, 512)
    LSTMLayer                        2100224    (64, None, 512)
    DropoutLayer                     0          (64, None, 512)
    ReshapeLayer                     0          (None, 512)
    DenseLayer                       77463      (None, 151)
Traceback (most recent call last):
  File "train_rnn.py", line 160, in <module>
    train = theano.function([x, mask], loss, updates=updates)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/compile/function.py", line 317, in function
    output_keys=output_keys)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/compile/pfunc.py", line 486, in pfunc
    output_keys=output_keys)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/compile/function_module.py", line 1839, in orig_function
    name=name)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/compile/function_module.py", line 1519, in __init__
    optimizer_profile = optimizer(fgraph)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 108, in __call__
    return self.optimize(fgraph)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 97, in optimize
    ret = self.apply(fgraph, *args, **kwargs)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 97, in optimize
    ret = self.apply(fgraph, *args, **kwargs)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 2510, in apply
    self.local_optimizers_map.get(node.op, [])):
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/scan_module/scan_op.py", line 706, in __hash__
    scan_utils.hash_listsDictsTuples(self.info)))
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/scan_module/scan_utils.py", line 177, in hash_listsDictsTuples
    hash_value ^= hash_listsDictsTuples(k)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/scan_module/scan_utils.py", line 179, in hash_listsDictsTuples
    elif isinstance(x, (list, tuple)):
KeyboardInterrupt
