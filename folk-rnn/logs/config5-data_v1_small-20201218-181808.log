vocabulary size: 3956
n tunes: 258
n train tunes: 194
n validation tunes: 64
min, max length 12 273
Building the model
  number of parameters: 31033348
  layer output shapes:               #params:   output shape:
    InputLayer                       0          (64, None)
    EmbeddingLayer                   15649936   (64, None, 3956)
    InputLayer                       0          (64, None)
    LSTMLayer                        9153536    (64, None, 512)
    DropoutLayer                     0          (64, None, 512)
    LSTMLayer                        2100224    (64, None, 512)
    DropoutLayer                     0          (64, None, 512)
    LSTMLayer                        2100224    (64, None, 512)
    DropoutLayer                     0          (64, None, 512)
    ReshapeLayer                     0          (None, 512)
    DenseLayer                       2029428    (None, 3956)
Traceback (most recent call last):
  File "train_rnn.py", line 160, in <module>
    train = theano.function([x, mask], loss, updates=updates)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/compile/function.py", line 317, in function
    output_keys=output_keys)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/compile/pfunc.py", line 486, in pfunc
    output_keys=output_keys)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/compile/function_module.py", line 1839, in orig_function
    name=name)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/compile/function_module.py", line 1519, in __init__
    optimizer_profile = optimizer(fgraph)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 108, in __call__
    return self.optimize(fgraph)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 97, in optimize
    ret = self.apply(fgraph, *args, **kwargs)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 97, in optimize
    ret = self.apply(fgraph, *args, **kwargs)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 97, in optimize
    ret = self.apply(fgraph, *args, **kwargs)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/tensor/opt.py", line 7356, in apply
    new_outputs = self.optimizer(node)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/tensor/opt.py", line 7287, in local_fuse
    C = scalar.Composite(s_inputs, s_new_out)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/scalar/basic.py", line 3973, in __init__
    self.init_fgraph()       # self.fgraph
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/scalar/basic.py", line 3919, in init_fgraph
    fgraph = FunctionGraph(self.inputs, self.outputs)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/fg.py", line 137, in __init__
    inputs, outputs = graph.clone(inputs, outputs)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/graph.py", line 862, in clone
    equiv = clone_get_equiv(i, o, copy_inputs, copy_orphans)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/graph.py", line 916, in clone_get_equiv
    new_apply = apply.clone_with_new_inputs([memo[i] for i in apply.inputs])
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/graph.py", line 249, in clone_with_new_inputs
    new_node = self.clone()
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/graph.py", line 207, in clone
    [output.clone() for output in self.outputs])
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/graph.py", line 453, in clone
    cp = self.__class__(self.type, None, None, self.name)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/graph.py", line 388, in __init__
    self.index = index
KeyboardInterrupt
