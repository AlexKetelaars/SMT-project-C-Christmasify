vocabulary size: 5371
n tunes: 358
n train tunes: 294
n validation tunes: 64
min, max length 10 273
Building the model
  number of parameters: 47854868
  layer output shapes:               #params:   output shape:
    InputLayer                       0          (64, None)
    EmbeddingLayer                   28847641   (64, None, 5371)
    InputLayer                       0          (64, None)
    LSTMLayer                        12051456   (64, None, 512)
    DropoutLayer                     0          (64, None, 512)
    LSTMLayer                        2100224    (64, None, 512)
    DropoutLayer                     0          (64, None, 512)
    LSTMLayer                        2100224    (64, None, 512)
    DropoutLayer                     0          (64, None, 512)
    ReshapeLayer                     0          (None, 512)
    DenseLayer                       2755323    (None, 5371)
Traceback (most recent call last):
  File "train_rnn.py", line 160, in <module>
    train = theano.function([x, mask], loss, updates=updates)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/compile/function.py", line 317, in function
    output_keys=output_keys)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/compile/pfunc.py", line 486, in pfunc
    output_keys=output_keys)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/compile/function_module.py", line 1839, in orig_function
    name=name)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/compile/function_module.py", line 1519, in __init__
    optimizer_profile = optimizer(fgraph)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 108, in __call__
    return self.optimize(fgraph)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 97, in optimize
    ret = self.apply(fgraph, *args, **kwargs)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 251, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 97, in optimize
    ret = self.apply(fgraph, *args, **kwargs)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 2513, in apply
    lopt_change = self.process_node(fgraph, node, lopt)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 2034, in process_node
    replacements = lopt.transform(node)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/tensor/opt.py", line 3091, in local_subtensor_merge
    ushape[pos_2]))
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/tensor/opt.py", line 3037, in merge_two_slices
    stop = pre_greedy_local_optimizer(list_opt, stop)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 2923, in pre_greedy_local_optimizer
    list_optimizations, out, {}, 0)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 2895, in local_recursive_function
    depth + 1)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/opt.py", line 2907, in local_recursive_function
    ret = opt.transform(node)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/tensor/opt.py", line 4029, in local_useless_switch
    copy_stack_trace(node.outputs + correct_out, out)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/tensor/var.py", line 230, in __radd__
    return theano.tensor.basic.add(other, self)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/op.py", line 615, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/tensor/elemwise.py", line 482, in make_node
    DimShuffle, *inputs)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/tensor/elemwise.py", line 438, in get_output_info
    ['x'] * difference + list(range(length)))(input))
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/tensor/elemwise.py", line 157, in __init__
    COp.__init__(self, [self.c_func_file], self.c_func_name)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/op.py", line 1308, in __init__
    self.load_c_code(func_files)
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/op.py", line 1327, in load_c_code
    func_files = [self.get_path(f) for f in func_files]
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/site-packages/theano/gof/op.py", line 1292, in get_path
    f = os.path.realpath(os.path.join(class_dir, f))
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/posixpath.py", line 382, in realpath
    path, ok = _joinrealpath('', filename, {})
  File "/Users/marcopellegrino/opt/anaconda3/envs/py2/lib/python2.7/posixpath.py", line 397, in _joinrealpath
    if name == pardir:
KeyboardInterrupt
